1. Salaries Differences 

WITH max_dep AS
    (SELECT department, max(salary) max_sal
    FROM db_employee de
    JOIN db_dept dd ON de.department_id = dd.id
    GROUP BY department)
    
SELECT 
    ABS((SELECT max_sal from max_dep WHERE department = 'marketing')
        - (SELECT max_sal from max_dep WHERE department = 'engineering'))

-- different approach
SELECT 
    ABS(MAX(CASE WHEN department = 'marketing' THEN salary ELSE NULL END)
    - MAX(CASE WHEN department = 'engineering' THEN salary ELSE NULL END)) AS DIFF
FROM db_employee de
JOIN db_dept dd ON de.department_id = dd.id

2. Employees Current Salary

SELECT 
    id, first_name, last_name, department_id, MAX(salary) current_salary
FROM ms_employee_salary
GROUP BY id
ORDER BY id

3. Bikes Last Used

select 
    bike_number, max(end_time) last_used
from dc_bikeshare_q1_2012
group by bike_number
order by max(end_time);

4. Count the number of movies that Abigail Breslin nominated for oscar

select count(*)
from oscar_nominees
where nominee = 'Abigail Breslin';

5. Find all posts which were reacted to with a heart

select
    distinct fp.*
from facebook_posts fp
join facebook_reactions fr on fp.post_id = fr.post_id
where fr.reaction = 'heart';
